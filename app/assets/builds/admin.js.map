{
  "version": 3,
  "sources": ["../../javascript/src/admin/ajax_table.js", "../../javascript/src/admin/new_batch_ingest.js"],
  "sourcesContent": ["document.addEventListener('turbolinks:load', () => {\n  function renderNewTable() {\n    const $form = $(this).closest('form');\n    let action = $form.attr('action');\n    if (!action) {\n      action = window.location.href;\n    }\n    $.get(action, $form.serialize(), null, 'script');\n    return false;\n  }\n\n  function ajaxLink() {\n    $.getScript(this.href);\n    return false;\n  }\n  // Fetch new table for autocomplete and filter widgets\n  $('.js-autocomplete select').change(renderNewTable);\n\n  // TODO: Could be improved. Should maybe bring in a `debounce` function for this search\n  $('.js-autocomplete input').keyup(renderNewTable);\n\n  // Sorting and pagination links\n  $('#js-ajax-table').on('click', ' th a.sort_link, .pagination a', ajaxLink);\n});\n", "/* eslint-disable no-undef */\n\nfunction addFileInput(id, name) {\n  if (\n    $('.js-batch-ingest-files-list').find(`input[value='${id}']`).length === 0\n  ) {\n    const input = `<li class=\"list-group-item d-flex justify-content-between\">\n        <input type=\"hidden\" name=\"batch_ingest[batch_ingest_files_attributes][][google_file_name]\" value=\"${name}\">\n        <input type=\"hidden\" name=\"batch_ingest[batch_ingest_files_attributes][][google_file_id]\" value=\"${id}\">\n        ${name}\n        <button type=\"button\" class=\"btn btn-danger btn-sm js-btn-delete-file\">\n          <i class=\"fa fa-trash-alt\" aria-hidden=\"true\"></i> Delete\n        </button>\n      </li>`;\n\n    $('.js-batch-ingest-files-list').append(input);\n  }\n}\n\nfunction addSpreadsheetInput(id, name) {\n  const input = `<li class=\"list-group-item d-flex justify-content-between\">\n      <input type=\"hidden\" name=\"batch_ingest[google_spreadsheet_name]\" value=\"${name}\">\n      <input type=\"hidden\" name=\"batch_ingest[google_spreadsheet_id]\" value=\"${id}\">\n      ${name}\n      <button type=\"button\" class=\"btn btn-danger btn-sm js-btn-delete-file\">\n        <i class=\"fa fa-trash-alt\" aria-hidden=\"true\"></i> Delete\n      </button>\n    </li>`;\n\n  $('.js-batch-ingest-spreadsheet').append(input);\n  $('.js-btn-spreadsheet').addClass('d-none');\n}\n\nfunction deleteFileFromFilesList() {\n  $(this).closest('li').remove();\n}\n\nfunction deleteSpreadsheet() {\n  $(this).closest('li').remove();\n  $('.js-btn-spreadsheet').removeClass('d-none');\n}\n\nfunction pickerFilesCallback(data) {\n  if (data.action === google.picker.Action.PICKED) {\n    data.docs.forEach((doc) => {\n      addFileInput(doc.id, doc.name);\n    });\n  }\n}\n\nfunction pickerSpreadsheetCallback(data) {\n  if (data.action === google.picker.Action.PICKED) {\n    addSpreadsheetInput(data.docs[0].id, data.docs[0].name);\n  }\n}\n\nfunction createFilesPicker() {\n  const { developerKey, accessToken } = this.dataset;\n\n  if (accessToken && developerKey) {\n    const view = new google.picker.DocsView(google.picker.ViewId.DOCS);\n    view.setMimeTypes(\n      'application/epub+zip,'\n        + 'application/excel,'\n        + 'application/gzip,'\n        + 'application/json,'\n        + 'application/mp4,'\n        + 'application/msword,'\n        + 'application/octet-stream,'\n        + 'application/pdf,'\n        + 'application/postscript,'\n        + 'application/rtf,'\n        + 'application/sql,'\n        + 'application/vnd.android.package-archive,'\n        + 'application/vnd.ms-access,'\n        + 'application/vnd.ms-asf,'\n        + 'application/vnd.ms-excel,'\n        + 'application/vnd.ms-excel.sheet.binary.macroenabled.12,'\n        + 'application/vnd.ms-excel.sheet.macroenabled.12,'\n        + 'application/vnd.ms-powerpoint,'\n        + 'application/vnd.oasis.opendocument.text,'\n        + 'application/vnd.openxmlformats-officedocument.presentationml.presentation,'\n        + 'application/vnd.openxmlformats-officedocument.presentationml.slideshow,'\n        + 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,'\n        + 'application/vnd.openxmlformats-officedocument.wordprocessingml.document,'\n        + 'application/vnd.openxmlformats-officedocument.wordprocessingml.template,'\n        + 'application/x-7z-compressed,'\n        + 'application/x-bibtex,'\n        + 'application/x-bibtex-text-file,'\n        + 'application/x-ole-storage,'\n        + 'application/x-rar,'\n        + 'application/x-rar-compressed,'\n        + 'application/x-spss-sav,'\n        + 'application/x-tar,'\n        + 'application/x-xz,'\n        + 'application/x-zip-compressed,'\n        + 'application/xml,'\n        + 'application/zip,'\n        + 'audio/mp4,'\n        + 'audio/mpeg,'\n        + 'audio/vnd.wave,'\n        + 'audio/wav,'\n        + 'audio/x-m4a,'\n        + 'audio/x-mpegurl,'\n        + 'audio/x-ms-asx,'\n        + 'audio/x-ms-wma,'\n        + 'audio/x-ms-wmv,'\n        + 'audio/x-wav,'\n        + 'audio/x-wave,'\n        + 'image/gif,'\n        + 'image/jpeg,'\n        + 'image/png,'\n        + 'image/svg+xml,'\n        + 'image/tiff,'\n        + 'inode/x-empty,'\n        + 'message/rfc822,'\n        + 'text/comma-separated-values,'\n        + 'text/csv,'\n        + 'text/html,'\n        + 'text/plain,'\n        + 'text/rtf,'\n        + 'text/x-bibtex,'\n        + 'text/x-csrc,'\n        + 'text/x-matlab,'\n        + 'text/x-objcsrc,'\n        + 'text/x-r-source,'\n        + 'text/x-r-sweave,'\n        + 'video/mp4,'\n        + 'video/mpeg,'\n        + 'video/quicktime,'\n        + 'video/x-flv,'\n        + 'video/x-m4v,'\n        + 'video/x-ms-wmv,'\n        + 'video/x-msvideo',\n    );\n    view.setIncludeFolders(true);\n    view.setParent('root');\n\n    const picker = new google.picker.PickerBuilder()\n      .setTitle('Select a file(s)')\n      .enableFeature(google.picker.Feature.NAV_HIDDEN)\n      .enableFeature(google.picker.Feature.MULTISELECT_ENABLED)\n      .enableFeature(google.picker.Feature.SUPPORT_DRIVES)\n      .setOAuthToken(accessToken)\n      .addView(view)\n      .setDeveloperKey(developerKey)\n      .setCallback(pickerFilesCallback)\n      .build();\n    picker.setVisible(true);\n  }\n}\n\nfunction createSpreadsheetPicker() {\n  const { developerKey, accessToken } = this.dataset;\n\n  if (accessToken && developerKey) {\n    const view = new google.picker.View(google.picker.ViewId.SPREADSHEETS);\n    view.setMimeTypes('application/vnd.google-apps.spreadsheet');\n    view.setParent('root');\n\n    const picker = new google.picker.PickerBuilder()\n      .setTitle('Select a spreadsheet')\n      .enableFeature(google.picker.Feature.NAV_HIDDEN)\n      .setOAuthToken(accessToken)\n      .addView(view)\n      .setDeveloperKey(developerKey)\n      .setCallback(pickerSpreadsheetCallback)\n      .build();\n    picker.setVisible(true);\n  }\n}\n\nfunction registerClickEvents() {\n  document\n    .querySelector('.js-btn-spreadsheet')\n    .addEventListener('click', createSpreadsheetPicker);\n  document\n    .querySelector('.js-btn-files')\n    .addEventListener('click', createFilesPicker);\n}\n\nfunction loadAndInitGAPI() {\n  return new Promise((resolve, reject) => {\n    const script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.src = 'https://apis.google.com/js/api.js';\n    script.onload = (e) => {\n      window.gapi.load('picker', { callback: registerClickEvents });\n    };\n    document.getElementsByTagName('head')[0].appendChild(script);\n  });\n}\n\ndocument.addEventListener('turbolinks:load', () => {\n  if (document.querySelector('.js-batch-ingest-spreadsheet')) {\n    loadAndInitGAPI();\n    $('.js-batch-ingest-spreadsheet').on(\n      'click',\n      '.js-btn-delete-file',\n      deleteSpreadsheet,\n    );\n    $('.js-batch-ingest-files-list').on(\n      'click',\n      '.js-btn-delete-file',\n      deleteFileFromFilesList,\n    );\n  }\n});\n"],
  "mappings": "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",
  "names": []
}
